<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
          Sign in with Apple - undefined
        
    </title>

    <link rel="canonical" href="http://example.com/2019/09/24/20190730/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/hux-blog.min.css">


    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 6.3.0"></head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Qianxing&#39;s Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Image to hack wechat -->
<!-- <img src="http://example.com/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="{{ site.baseurl }}/{% if page.header-img %}{{ page.header-img }}{% else %}{{ site.header-img }}{% endif %}" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/undefined')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                          <a class="tag" href="/tags/#iOS" title="iOS">iOS</a>
                        
                    </div>
                    <h1>Sign in with Apple</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by Qianxing on
                        2019-09-24
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <p>æ–‡ç« å·²å‘å¸ƒè‡³å…¬è´¦å·ï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI0MzgxNDkyNw==&mid=2247483656&idx=1&sn=41c79bb9a971d4aedb89977a24d872a1&chksm=e9660668de118f7e7630d48454734ee872bba7065981db97acb04ac131bb3acb177cc2cdc448&token=395919763&lang=zh_CN#rd">Sign in with Apple</a></p>
<blockquote>
<p>é€šè¿‡æœ¬æ–‡ï¼Œä½ å°†äº†è§£åˆ°æ˜¯å¦éœ€è¦é›†æˆ<code>Sign in with Apple</code>åŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•é›†æˆ<code>Sign in with Apple</code>åŠŸèƒ½ã€‚</p>
</blockquote>
<p>æœ¬æ–‡ä¸»è¦è®²è§£ä»¥ä¸‹å†…å®¹</p>
<ul>
<li>æ¦‚è§ˆ</li>
<li>é›†æˆ</li>
</ul>
<h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p>åœ¨ WWDC 2019 ä¸Šï¼Œè‹¹æœæ¨å‡ºäº†è‡ªå®¶çš„<code>Sign in with Apple</code>åŠŸèƒ½ï¼Œè¿™å¾ˆ<code>Apple</code>ã€‚å¯èƒ½è‹¹æœçœ‹åˆ°ç¬¬ä¸‰æ–¹ç™»å½•ç™¾å®¶äº‰é¸£ï¼Œç¢ç£¨ç€è‡ªå·±ä¹Ÿæäº†ä¸ªï¼Œè¿™å¯¹å¾ˆå¤šç¬¬ä¸‰æ–¹ç™»å½•æ¥è¯´å¯èƒ½æ˜¯ä¸ªå¨èƒã€‚</p>
<p>è‹¹æœå¯¹<code>Sign in with Apple</code>çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>Sign In with Apple makes it easy for users to sign in to your apps and websites using their Apple ID. Instead of filling out forms, verifying email addresses, and choosing new passwords, they can use Sign In with Apple to set up an account and start using your app right away. All accounts are protected with two-factor authentication for superior security, and Apple will not track usersâ€™ activity in your app or website.</p>
</blockquote>
<p>ä½¿ç”¨<code>Sign in with Apple</code>ä¼šæ›´åŠ æ–¹ä¾¿ã€å¿«æ·ã€å®‰å…¨ï¼Œè‹¹æœä¸ä¼šè¿½è¸ªç”¨æˆ·åœ¨åº”ç”¨ä¸­çš„è¡Œä¸ºã€‚æ‰€ä»¥ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ä½¿ç”¨<code>Sign in with Apple</code>ä¼šæ›´åŠ å®‰å…¨ã€‚</p>
<p>å¦å¤–ï¼Œ<code>Sign in with Apple</code>æ”¯æŒè·¨å¹³å°</p>
<ul>
<li>Native SDK æ”¯æŒ iOS&#x2F;MacOS&#x2F;watchOS&#x2F;tvOS</li>
<li>Javascript SDK æ”¯æŒ  Android, Windows, Web</li>
</ul>
<p>è¯è¯´è¿™ä¸ª iOS 13 æ‰æ”¯æŒçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æœ‰å¿…è¦é›†æˆå—ï¼ŸğŸ¤”</p>
<p>çœ‹äº†ä¸‹é¢è¿™å¥è¯ï¼Œä½ æˆ–è®¸å°±æœ‰ç­”æ¡ˆäº†ã€‚</p>
<blockquote>
<p>Sign In with Apple will be available for beta testing this summer. It will be required as an option for users in apps that support third-party sign-in when it is commercially available later this year.</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ çš„<code>App</code>æ²¡æœ‰æä¾›ç¬¬ä¸‰æ–¹ç™»å½•ï¼Œé‚£å°±ä¸ç”¨é›†æˆã€‚å¦‚æœç”¨åˆ°äº†ç¬¬ä¸‰æ–¹ç™»å½•ï¼Œé‚£ä¹ˆéœ€è¦æä¾›<code>Sign in with Apple</code>ã€‚</p>
<h1 id="é›†æˆ"><a href="#é›†æˆ" class="headerlink" title="é›†æˆ"></a>é›†æˆ</h1><p>é›†æˆ éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/1.png"></p>
<h2 id="ä¸€ã€å‡†å¤‡å·¥ä½œ"><a href="#ä¸€ã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="ä¸€ã€å‡†å¤‡å·¥ä½œ"></a>ä¸€ã€å‡†å¤‡å·¥ä½œ</h2><p>å¼€å¯<code>Sign in with Apple</code>åŠŸèƒ½</p>
<p>1.ç™»å½•å¼€å‘è€…ç½‘ç«™ï¼Œåœ¨éœ€è¦æ·»åŠ <code>Sign in with Apple</code>åŠŸèƒ½çš„<code>Identifier</code>å¼€å¯åŠŸèƒ½ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/2.png"></p>
<p>2.<code>Xcode</code>é‡Œé¢<code>Signing &amp; Capabilities</code>å¼€å¯<code>Sign in with Apple</code>åŠŸèƒ½ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/3.png"></p>
<h2 id="äºŒã€ä»£ç é›†æˆ"><a href="#äºŒã€ä»£ç é›†æˆ" class="headerlink" title="äºŒã€ä»£ç é›†æˆ"></a>äºŒã€ä»£ç é›†æˆ</h2><blockquote>
<p>Talk is cheap. Show me the codeï¼ğŸ˜Œ</p>
</blockquote>
<h4 id="1-åˆ›å»ºç™»å½•æŒ‰é’®"><a href="#1-åˆ›å»ºç™»å½•æŒ‰é’®" class="headerlink" title="1.åˆ›å»ºç™»å½•æŒ‰é’®"></a>1.åˆ›å»ºç™»å½•æŒ‰é’®</h4><p>å®˜æ–¹æä¾›äº†ä¸€ä¸ª<code>ASAuthorizationAppleIDButton</code>ï¼ˆç»§æ‰¿è‡ª<code>UIControl</code>ï¼‰ï¼Œä½¿ç”¨è¿™ä¸ªæ¥åˆ›å»ºä¸€ä¸ªç™»å½•æŒ‰é’®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ASAuthorizationAppleIDButton *button = [ASAuthorizationAppleIDButton buttonWithType:ASAuthorizationAppleIDButtonTypeSignIn style:ASAuthorizationAppleIDButtonStyleWhite];</span><br><span class="line">[button addTarget:self</span><br><span class="line">           action:@selector(signInWithApple)</span><br><span class="line"> forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">button.center = self.view.center;</span><br><span class="line">[self.view addSubview:button];</span><br></pre></td></tr></table></figure>


<p>è¿™ä¸ªæŒ‰é’®å…·æœ‰ä¸¤ç§æ–‡æ¡ˆç±»å‹å’Œä¸‰ä¸ªæ ·å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSInteger, ASAuthorizationAppleIDButtonType) &#123;</span><br><span class="line">    ASAuthorizationAppleIDButtonTypeSignIn,</span><br><span class="line">    ASAuthorizationAppleIDButtonTypeContinue,</span><br><span class="line"></span><br><span class="line">    ASAuthorizationAppleIDButtonTypeDefault = ASAuthorizationAppleIDButtonTypeSignIn,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">typedef NS_ENUM(NSInteger, ASAuthorizationAppleIDButtonStyle) &#123;</span><br><span class="line">    ASAuthorizationAppleIDButtonStyleWhite,</span><br><span class="line">    ASAuthorizationAppleIDButtonStyleWhiteOutline,</span><br><span class="line">    ASAuthorizationAppleIDButtonStyleBlack,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡å›¾ç‰‡å¯èƒ½æ›´ç›´è§‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/4.jpeg"></p>
<p>ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼š</p>
<ul>
<li>Apple æä¾›çš„ç™»å½•æŒ‰é’®æœ‰ä¸‰ç§å¤–è§‚ï¼šç™½è‰²ï¼Œå¸¦æœ‰é»‘è‰²è½®å»“çº¿çš„ç™½è‰²å’Œé»‘è‰²ã€‚</li>
<li>æ–‡æ¡ˆæœ‰ä¸¤ç§ï¼š<code>Sign In with Apple</code> å’Œ <code>Continue with Apple</code>ã€‚ï¼ˆå…·ä½“ä½¿ç”¨å“ªä¸ªæ–‡æ¡ˆï¼Œæ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€æ±‚æ¥å®šï¼‰<br>å¦å¤–ï¼ŒæŒ‰é’®å®½é«˜é»˜è®¤å€¼ä¸º <code>&#123;width:130, height:30&#125;</code>ã€‚</li>
</ul>
<p>å¯¹äº<code>ASAuthorizationAppleIDButton</code>æˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰çš„ä¸œè¥¿æ¯”è¾ƒå°‘ï¼Œæ¯”å¦‚èƒŒæ™¯è‰²ä¸èƒ½æ›´æ”¹ï¼Œæ–‡æ¡ˆåªæœ‰ä¸¤ç§å¯é€‰ï¼Œå¹¶ä¸”å€¼ä¸èƒ½ä¿®æ”¹ï¼Œå¯ä»¥è°ƒæ•´çš„åªæœ‰åœ†è§’<code>cornerRadius</code>å’Œ<code>size</code>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/5.png"></p>
<p>å®½é«˜ä¹Ÿæœ‰ä¸€å®šé™åˆ¶ï¼š</p>
<table>
<thead>
<tr>
<th>Minimum width</th>
<th>Minimum height</th>
<th>Minimum margin</th>
</tr>
</thead>
<tbody><tr>
<td>140pt (140px @1x, 280px @2x)</td>
<td>30pt (30px @1x, 60px @2x)</td>
<td>1&#x2F;10 of the buttonâ€™s height</td>
</tr>
</tbody></table>
<p>å…·ä½“çš„è®¾è®¡è§„èŒƒï¼Œè¯·å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://developer.apple.com/design/human-interface-guidelines/sign-in-with-apple">Human Interface Guidelines</a></p>
<p>é€šè¿‡è°ƒæ•´<code>size</code>å‘ç°è¿˜æœ‰ä¸ªæ–°èŠ±æ ·ã€‚æ¯”å¦‚è¿™æ ·ï¼š</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/6.png"></p>
<p>æ˜¯ä¸æ˜¯å‘ç°æ–‡å­—æ²¡æœ‰äº†ï¼Œå½“ç„¶æœ‰äº›ç«¥é‹å¯èƒ½ä¼šè¯´ï¼Œå˜æˆåœ†å½¢çš„äº†ã€‚å—¯ï¼Œåœ†å½¢è¿˜æ˜¯æ¯”è¾ƒç®€å•è®¾ç½®çš„ï¼Œä¸»è¦çš„å˜åŒ–è¿˜æ˜¯æ–‡å­—ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‘ç°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒå¤§å°ºå¯¸ï¼Œé‡Œé¢çš„è‹¹æœ logo ä¹Ÿä¼šè·Ÿç€å˜å¤§ï¼Œé€‚åº”å±•ç¤ºã€‚å…·ä½“æ€ä¹ˆæ“ä½œï¼Œçœ‹ä¸‹é¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ASAuthorizationAppleIDButton *button = [ASAuthorizationAppleIDButton buttonWithType:ASAuthorizationAppleIDButtonTypeContinue style:ASAuthorizationAppleIDButtonStyleBlack];</span><br><span class="line">button.bounds = CGRectMake(0, 0, 40, 40);</span><br><span class="line">button.cornerRadius = 20.0f;</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡ä¸Šé¢è¿™ç§æ–¹å¼ï¼Œä¸çŸ¥é“å®¡æ ¸æ˜¯å¦å¯ä»¥é€šè¿‡å“ˆï¼Œå¤§å®¶è¿˜æ˜¯æ…ç”¨ï¼Œä»…ä½œä¸ºä¸€ç§å‚è€ƒã€‚ä¸è¿‡ï¼Œè‹¹æœè²Œä¼¼æ²¡æœ‰å¼ºåˆ¶ä½¿ç”¨é»˜è®¤çš„ç™»å½•æŒ‰é’®ã€‚</p>
<blockquote>
<p>To help people set up an account and sign in, itâ€™s best to use the familiar buttons that Apple provides for Sign In with Apple.</p>
</blockquote>
<p>å†è¡¥å……ä¸€ç‚¹ï¼Œé€šè¿‡ä¸Šé¢è¿™ç§ä¿®æ”¹<code>size</code>åï¼Œä¼šæ”¶åˆ°å¸ƒå±€è­¦å‘Šâš ï¸ï¼Œé€šè¿‡è­¦å‘Šä¿¡æ¯ï¼Œå¤§è‡´å¯ä»¥çœ‹å‡ºæ¥ï¼ŒæŒ‰é’®å®½åº¦çš„èŒƒå›´æ˜¯ï¼š<code>&gt;= 130px</code>ï¼Œé«˜åº¦èŒƒå›´æ˜¯ï¼š<code>&gt;=30px &amp;&amp; &lt;=64px</code>ã€‚</p>
<p><strong>æœ¬åœ°åŒ–</strong>ï¼šå¿…è¦ä¸”é‡è¦çš„ä¸€ç‚¹</p>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ï¼ŒæŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—éƒ½æ˜¯è‹±æ–‡çš„ï¼Œè€Œä¸”æˆ‘ä»¬ä¸å¯ä»¥ä¿®æ”¹æ–‡å­—ï¼Œé‚£æˆ‘æ€»ä¸èƒ½åœ¨å›½å†…ä¹Ÿå±•ç¤ºä¸ªè‹±æ–‡å§ğŸ™„ã€‚å…¶å®ï¼Œè¿™æ˜¯ä¸ªåŸºç¡€æ€§çš„é—®é¢˜ï¼ŒçŸ¥é“çš„ç«¥é‹å¯ä»¥è·³è¿‡äº†ï¼Œä¸æ¸…æ¥šçš„ç«¥é‹ç»§ç»­çœ‹ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆç®€å•ï¼Œè¦çŸ¥é“<code>Apple</code>å·²ç»ä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šçš„å·¥ä½œï¼Œç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ æœ¬åœ°åŒ–æ”¯æŒå°±å¯ä»¥äº†ï¼Œæ­¤æ–¹æ³•é€‚ç”¨äºä¸€åˆ‡ç³»ç»Ÿæ–‡æ¡ˆï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºçš„<code>UIBarButtonSystemItemSave</code>ï¼Œæ·»åŠ ç®€ä½“ä¸­æ–‡æ”¯æŒåï¼Œä»–æ˜¾ç¤ºçš„æ–‡æ¡ˆå°±å˜æˆ ä¿å­˜ å•¦ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/7.jpeg"></p>
<p>ä¸Šå›¾å°±æ˜¯æ·»åŠ æœ¬åœ°åŒ–è¯­è¨€ï¼Œè¿˜ä¸ä¼šçš„ç«¥é‹ï¼Œè‡ªå·±ç½‘ä¸ŠæŸ¥æŸ¥å§ï¼Œè¿™é‡Œä¸åœ¨å±•å¼€äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯æ·»åŠ äº†æœ¬åœ°è¯­è¨€ä¹‹åçš„æ•ˆæœï¼š</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/8.jpeg"></p>
<h4 id="2-Authorization-å‘èµ·æˆæƒç™»å½•è¯·æ±‚"><a href="#2-Authorization-å‘èµ·æˆæƒç™»å½•è¯·æ±‚" class="headerlink" title="2.Authorization å‘èµ·æˆæƒç™»å½•è¯·æ±‚"></a>2.Authorization å‘èµ·æˆæƒç™»å½•è¯·æ±‚</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (void)signInWithApple API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    ASAuthorizationAppleIDProvider *provider = [[ASAuthorizationAppleIDProvider alloc] init];</span><br><span class="line">    ASAuthorizationAppleIDRequest *request = [provider createRequest];</span><br><span class="line">    request.requestedScopes = @[ASAuthorizationScopeFullName, ASAuthorizationScopeEmail];</span><br><span class="line">    </span><br><span class="line">    ASAuthorizationController *vc = [[ASAuthorizationController alloc] initWithAuthorizationRequests:@[request]];</span><br><span class="line">    vc.delegate = self;</span><br><span class="line">    vc.presentationContextProvider = self;</span><br><span class="line">    [vc performRequests];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æï¼š</p>
<ul>
<li><p><code>ASAuthorizationAppleIDProvider</code>è¿™ä¸ªç±»æ¯”è¾ƒç®€å•ï¼Œå¤´æ–‡ä»¶ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸»è¦ç”¨äºåˆ›å»ºä¸€ä¸ª<code>ASAuthorizationAppleIDRequest</code>ä»¥åŠè·å–å¯¹åº”<code>userID</code>çš„ç”¨æˆ·æˆæƒçŠ¶æ€ã€‚åœ¨ä¸Šé¢çš„æ–¹æ³•ä¸­æˆ‘ä»¬ä¸»è¦æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ª<code>ASAuthorizationAppleIDRequest</code>ï¼Œç”¨æˆ·æˆæƒçŠ¶æ€çš„è·å–åé¢ä¼šæåˆ°ã€‚</p>
</li>
<li><p>ç»™åˆ›å»ºçš„<code>request</code>è®¾ç½®<code>requestedScopes</code>ï¼Œè¿™æ˜¯ä¸ª<code>ASAuthorizationScope</code>æ•°ç»„ï¼Œç›®å‰åªæœ‰ä¸¤ä¸ªå€¼ï¼Œ<code>ASAuthorizationScopeFullName</code>å’Œ <code>ASAuthorizationScopeEmail</code>ï¼Œæ ¹æ®éœ€æ±‚å»è®¾ç½®å³å¯ã€‚</p>
</li>
<li><p>ç„¶åï¼Œåˆ›å»º<code>ASAuthorizationController</code>ï¼Œå®ƒæ˜¯ç®¡ç†æˆæƒè¯·æ±‚çš„æ§åˆ¶å™¨ï¼Œç»™å…¶è®¾ç½® <code>delegate</code>å’Œ<code>presentationContextProvider</code>ï¼Œæœ€åå¯åŠ¨æˆæƒ<code>performRequests</code>ã€‚</p>
</li>
</ul>
<p><strong>è®¾ç½®ä¸Šä¸‹æ–‡</strong></p>
<p><code>ASAuthorizationControllerPresentationContextProviding</code>å°±ä¸€ä¸ªæ–¹æ³•ï¼Œä¸»è¦æ˜¯å‘Šè¯‰<code>ASAuthorizationController</code>å±•ç¤ºåœ¨å“ªä¸ª<code>window</code>ä¸Šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - ASAuthorizationControllerPresentationContextProviding</span><br><span class="line"></span><br><span class="line">- (ASPresentationAnchor)presentationAnchorForAuthorizationController:(ASAuthorizationController *)controller API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    return self.view.window;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-Verification-æˆæƒ"><a href="#3-Verification-æˆæƒ" class="headerlink" title="3.Verification æˆæƒ"></a>3.Verification æˆæƒ</h4><p>ç”¨æˆ·å‘èµ·æˆæƒè¯·æ±‚åï¼Œç³»ç»Ÿå°±ä¼šå¼¹å‡ºç”¨æˆ·ç™»å½•éªŒè¯çš„é¡µé¢ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/9.jpeg"></p>
<p>åœ¨ç”¨æˆ·æ²¡æœ‰åŒæ„æˆæƒä¹‹å‰æˆ–è€…å–æ¶ˆæˆæƒä¹‹åï¼Œç‚¹å‡»ç™»å½•çš„æ—¶å€™ï¼Œéƒ½ä¼šå¼¹å‡ºä¸Šé¢è¿™ä¸ªç•Œé¢ï¼Œåœ¨è¿™ä¸ªæˆæƒé¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹è‡ªå·±çš„ç”¨æˆ·åï¼Œä»¥åŠå¯ä»¥é€‰æ‹©å…±äº«æˆ‘çš„ç”µå­é‚®ç®±æˆ–è€…éšè—é‚®ä»¶åœ°å€ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥è¾¾åˆ°éšè—è‡ªå·±çœŸå®ä¿¡æ¯çš„ç›®çš„ã€‚</p>
<p>æˆæƒä¸€æ¬¡åï¼Œå†æ¬¡ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼Œåˆ™ä¼šç›´æ¥å¼¹å‡ºä¸‹é¢è¿™ä¸ªçª—å£ï¼š</p>
<p><img src="https://raw.githubusercontent.com/jixuqianxing/BlogResources/main/20190730/10.jpeg"></p>
<p><strong>æˆæƒå›è°ƒå¤„ç†</strong></p>
<p>ä¸‹é¢æ˜¯<code>ASAuthorizationControllerDelegate</code>æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯æˆæƒæˆåŠŸçš„å›è°ƒï¼Œä¸€ä¸ªæ˜¯å¤±è´¥çš„å›è°ƒã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - ASAuthorizationControllerDelegate</span><br><span class="line"></span><br><span class="line">- (void)authorizationController:(ASAuthorizationController *)controller didCompleteWithAuthorization:(ASAuthorization *)authorization API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    if ([authorization.credential isKindOfClass:[ASAuthorizationAppleIDCredential class]])       &#123;</span><br><span class="line">        ASAuthorizationAppleIDCredential *credential = authorization.credential;</span><br><span class="line">        </span><br><span class="line">        NSString *state = credential.state;</span><br><span class="line">        NSString *userID = credential.user;</span><br><span class="line">        NSPersonNameComponents *fullName = credential.fullName;</span><br><span class="line">        NSString *email = credential.email;</span><br><span class="line">        NSString *authorizationCode = [[NSString alloc] initWithData:credential.authorizationCode encoding:NSUTF8StringEncoding]; // refresh token</span><br><span class="line">        NSString *identityToken = [[NSString alloc] initWithData:credential.identityToken encoding:NSUTF8StringEncoding]; // access token</span><br><span class="line">        ASUserDetectionStatus realUserStatus = credential.realUserStatus;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;state: %@&quot;, state);</span><br><span class="line">        NSLog(@&quot;userID: %@&quot;, userID);</span><br><span class="line">        NSLog(@&quot;fullName: %@&quot;, fullName);</span><br><span class="line">        NSLog(@&quot;email: %@&quot;, email);</span><br><span class="line">        NSLog(@&quot;authorizationCode: %@&quot;, authorizationCode);</span><br><span class="line">        NSLog(@&quot;identityToken: %@&quot;, identityToken);</span><br><span class="line">        NSLog(@&quot;realUserStatus: %@&quot;, @(realUserStatus));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)authorizationController:(ASAuthorizationController *)controller didCompleteWithError:(NSError *)error API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    NSString *errorMsg = nil;</span><br><span class="line">    switch (error.code) &#123;</span><br><span class="line">        case ASAuthorizationErrorCanceled:</span><br><span class="line">            errorMsg = @&quot;ç”¨æˆ·å–æ¶ˆäº†æˆæƒè¯·æ±‚&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case ASAuthorizationErrorFailed:</span><br><span class="line">            errorMsg = @&quot;æˆæƒè¯·æ±‚å¤±è´¥&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case ASAuthorizationErrorInvalidResponse:</span><br><span class="line">            errorMsg = @&quot;æˆæƒè¯·æ±‚å“åº”æ— æ•ˆ&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case ASAuthorizationErrorNotHandled:</span><br><span class="line">            errorMsg = @&quot;æœªèƒ½å¤„ç†æˆæƒè¯·æ±‚&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case ASAuthorizationErrorUnknown:</span><br><span class="line">            errorMsg = @&quot;æˆæƒè¯·æ±‚å¤±è´¥æœªçŸ¥åŸå› &quot;;</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">    NSLog(@&quot;%@&quot;, errorMsg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬æˆæƒæˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>authorizationController:didCompleteWithAuthorization:</code>è¿™ä¸ªä»£ç†æ–¹æ³•ä¸­è·å–åˆ°<code>ASAuthorizationAppleIDCredential</code>ï¼Œé€šè¿‡è¿™ä¸ªå¯ä»¥æ‹¿åˆ°ç”¨æˆ·çš„<code>userID</code>ã€<code>email</code>ã€<code>fullName</code>ã€<code>authorizationCode</code>ã€<code>identityToken</code>ä»¥åŠ <code>realUserStatus</code>ç­‰ä¿¡æ¯ã€‚</p>
<p>è¿™äº›ä¿¡æ¯å…·ä½“å«ä¹‰å’Œç”¨é€”ï¼š</p>
<ul>
<li><p><code>User ID</code>: Unique, stable, team-scoped user IDï¼Œè‹¹æœç”¨æˆ·å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œè¯¥å€¼åœ¨åŒä¸€ä¸ªå¼€å‘è€…è´¦å·ä¸‹çš„æ‰€æœ‰ App ä¸‹æ˜¯ä¸€æ ·çš„ï¼Œå¼€å‘è€…å¯ä»¥ç”¨è¯¥å”¯ä¸€æ ‡è¯†ç¬¦ä¸è‡ªå·±åå°ç³»ç»Ÿçš„è´¦å·ä½“ç³»ç»‘å®šèµ·æ¥ã€‚</p>
</li>
<li><p><code>Verification data</code>: Identity token, codeï¼ŒéªŒè¯æ•°æ®ï¼Œç”¨äºä¼ ç»™å¼€å‘è€…åå°æœåŠ¡å™¨ï¼Œç„¶åå¼€å‘è€…æœåŠ¡å™¨å†å‘è‹¹æœçš„èº«ä»½éªŒè¯æœåŠ¡ç«¯éªŒè¯æœ¬æ¬¡æˆæƒç™»å½•è¯·æ±‚æ•°æ®çš„æœ‰æ•ˆæ€§å’ŒçœŸå®æ€§ï¼Œè¯¦è§ Sign In with Apple REST APIã€‚å¦‚æœéªŒè¯æˆåŠŸï¼Œå¯ä»¥æ ¹æ® userIdentifier åˆ¤æ–­è´¦å·æ˜¯å¦å·²å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™è¿”å›è‡ªå·±è´¦å·ç³»ç»Ÿçš„ç™»å½•æ€ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦å·ï¼Œå¹¶è¿”å›å¯¹åº”çš„ç™»å½•æ€ç»™ Appã€‚</p>
</li>
<li><p><code>Account information</code>: Name, verified emailï¼Œè‹¹æœç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¨åã€é‚®ç®±ç­‰ã€‚</p>
</li>
<li><p><code>Real user indicator</code>: High confidence indicator that likely real userï¼Œç”¨äºåˆ¤æ–­å½“å‰ç™»å½•çš„è‹¹æœè´¦å·æ˜¯å¦æ˜¯ä¸€ä¸ªçœŸå®ç”¨æˆ·ï¼Œå–å€¼æœ‰ï¼šunsupportedã€unknownã€likelyRealã€‚</p>
</li>
</ul>
<p>å¤±è´¥æƒ…å†µä¼šèµ°<code>authorizationController:didCompleteWithError:</code>è¿™ä¸ªæ–¹æ³•ï¼Œå…·ä½“çœ‹ä»£ç å§ã€‚</p>
<h4 id="5-Handling-Changes"><a href="#5-Handling-Changes" class="headerlink" title="5. Handling Changes"></a>5. Handling Changes</h4><p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ä¸€ä¸ªå®Œæ•´çš„æˆæƒï¼Œå·²ç»å®Œæˆã€‚BUTï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†ä¸€äº› Caseã€‚</p>
<ul>
<li>ç”¨æˆ·ç»ˆæ­¢<code>App</code>ä¸­ä½¿ç”¨<code>Sign in with Apple</code>åŠŸèƒ½</li>
<li>ç”¨æˆ·åœ¨è®¾ç½®é‡Œæ³¨é”€äº†<code>AppleId</code></li>
</ul>
<p>è¿™äº›æƒ…å†µä¸‹ï¼Œ<code>App</code>éœ€è¦è·å–åˆ°è¿™äº›çŠ¶æ€ï¼Œç„¶ååšé€€å‡ºç™»å½•æ“ä½œï¼Œæˆ–è€…é‡æ–°ç™»å½•ã€‚<br>æˆ‘ä»¬éœ€è¦åœ¨<code>App</code>å¯åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡<code>getCredentialState:completion:</code>æ¥è·å–å½“å‰ç”¨æˆ·çš„æˆæƒçŠ¶æ€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</span><br><span class="line">    </span><br><span class="line">    if (@available(iOS 13.0, *)) &#123;</span><br><span class="line">        NSString *userIdentifier = é’¥åŒ™ä¸²ä¸­å–å‡ºçš„ userIdentifier;</span><br><span class="line">        if (userIdentifier) &#123;</span><br><span class="line">            ASAuthorizationAppleIDProvider *appleIDProvider = [ASAuthorizationAppleIDProvider new];</span><br><span class="line">            [appleIDProvider getCredentialStateForUserID:userIdentifier</span><br><span class="line">                                              completion:^(ASAuthorizationAppleIDProviderCredentialState credentialState,</span><br><span class="line">                                                           NSError * _Nullable error)</span><br><span class="line">            &#123;</span><br><span class="line">                switch (credentialState) &#123;</span><br><span class="line">                    case ASAuthorizationAppleIDProviderCredentialAuthorized:</span><br><span class="line">                        // The Apple ID credential is valid</span><br><span class="line">                        break;</span><br><span class="line">                    case ASAuthorizationAppleIDProviderCredentialRevoked:</span><br><span class="line">                        // Apple ID Credential revoked, handle unlink</span><br><span class="line">                        break;</span><br><span class="line">                    case ASAuthorizationAppleIDProviderCredentialNotFound:</span><br><span class="line">                        // Credential not found, show login UI</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>ASAuthorizationAppleIDProviderCredentialState</code>è§£æå¦‚ä¸‹ï¼š</p>
<ul>
<li><p><code>ASAuthorizationAppleIDProviderCredentialAuthorized</code>æˆæƒçŠ¶æ€æœ‰æ•ˆï¼›</p>
</li>
<li><p><code>ASAuthorizationAppleIDProviderCredentialRevoked</code>ä¸Šæ¬¡ä½¿ç”¨è‹¹æœè´¦å·ç™»å½•çš„å‡­æ®å·²è¢«ç§»é™¤ï¼Œéœ€è§£é™¤ç»‘å®šå¹¶é‡æ–°å¼•å¯¼ç”¨æˆ·ä½¿ç”¨è‹¹æœç™»å½•ï¼›</p>
</li>
<li><p><code>ASAuthorizationAppleIDProviderCredentialNotFound</code>æœªç™»å½•æˆæƒï¼Œç›´æ¥å¼¹å‡ºç™»å½•é¡µé¢ï¼Œå¼•å¯¼ç”¨æˆ·ç™»å½•ã€‚</p>
</li>
</ul>
<p>å¦å¤–ï¼Œåœ¨<code>App</code>ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡é€šçŸ¥æ–¹æ³•æ¥ç›‘å¬<code>revoked</code>çŠ¶æ€ï¼Œå¯ä»¥æ·»åŠ  <code>ASAuthorizationAppleIDProviderCredentialRevokedNotification</code>è¿™ä¸ªé€šçŸ¥ï¼Œæ”¶åˆ°è¿™ä¸ªé€šçŸ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>Sign user out on this device</li>
<li>Guide to sign in again</li>
</ul>
<p>å…·ä½“æ€ä¹ˆæ·»åŠ å’Œå¤„ç†ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ¥å†³å®šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (void)observeAppleSignInState</span><br><span class="line">&#123;</span><br><span class="line">    if (@available(iOS 13.0, *)) &#123;</span><br><span class="line">        [[NSNotificationCenter defaultCenter] addObserver:self</span><br><span class="line">                                                 selector:@selector(handleSignInWithAppleStateChanged:)</span><br><span class="line">                                                     name:ASAuthorizationAppleIDProviderCredentialRevokedNotification</span><br><span class="line">                                                   object:nil];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)handleSignInWithAppleStateChanged:(NSNotification *)notification</span><br><span class="line">&#123;</span><br><span class="line">    // Sign the user out, optionally guide them to sign in again</span><br><span class="line">    NSLog(@&quot;%@&quot;, notification.userInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-more-thing"><a href="#One-more-thing" class="headerlink" title="One more thing"></a>One more thing</h2><p>é™¤æ­¤ä¹‹å¤–ï¼Œè‹¹æœè¿˜æŠŠ<code>iCloud KeyChain password</code>é›†æˆåˆ°äº†è¿™å¥—<code>API</code>é‡Œï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨åˆ›å»º<code>request</code>çš„æ—¶å€™ï¼Œå¤šåˆ›å»ºä¸€ä¸ª<code>ASAuthorizationPasswordRequest</code>ï¼Œè¿™æ ·å¦‚æœ<code>KeyChain</code>é‡Œé¢ä¹Ÿæœ‰ç™»å½•ä¿¡æ¯çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é‡Œé¢ä¿å­˜çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">- (void)perfomExistingAccountSetupFlows API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    ASAuthorizationAppleIDProvider *appleIDProvider = [ASAuthorizationAppleIDProvider new];</span><br><span class="line">    ASAuthorizationAppleIDRequest *authAppleIDRequest = [appleIDProvider createRequest];</span><br><span class="line">    ASAuthorizationPasswordRequest *passwordRequest = [[ASAuthorizationPasswordProvider new] createRequest];</span><br><span class="line">    </span><br><span class="line">    NSMutableArray &lt;ASAuthorizationRequest *&gt;* array = [NSMutableArray arrayWithCapacity:2];</span><br><span class="line">    if (authAppleIDRequest) &#123;</span><br><span class="line">        [array addObject:authAppleIDRequest];</span><br><span class="line">    &#125;</span><br><span class="line">    if (passwordRequest) &#123;</span><br><span class="line">        [array addObject:passwordRequest];</span><br><span class="line">    &#125;</span><br><span class="line">    NSArray &lt;ASAuthorizationRequest *&gt;* requests = [array copy];</span><br><span class="line">    </span><br><span class="line">    ASAuthorizationController *authorizationController = [[ASAuthorizationController alloc] initWithAuthorizationRequests:requests];</span><br><span class="line">    authorizationController.delegate = self;</span><br><span class="line">    authorizationController.presentationContextProvider = self;</span><br><span class="line">    [authorizationController performRequests];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - ASAuthorizationControllerDelegate</span><br><span class="line"></span><br><span class="line">- (void)authorizationController:(ASAuthorizationController *)controller didCompleteWithAuthorization:(ASAuthorization *)authorization API_AVAILABLE(ios(13.0))</span><br><span class="line">&#123;</span><br><span class="line">    if ([authorization.credential isKindOfClass:[ASPasswordCredential class]]) &#123;</span><br><span class="line">        ASPasswordCredential *passwordCredential = authorization.credential;</span><br><span class="line">        NSString *userIdentifier = passwordCredential.user;</span><br><span class="line">        NSString *password = passwordCredential.password;</span><br><span class="line">        </span><br><span class="line">        NSLog(@&quot;userIdentifier: %@&quot;, userIdentifier);</span><br><span class="line">        NSLog(@&quot;password: %@&quot;, password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šå°±æ˜¯å…³äº<code>Sign in with Apple</code>çš„ç›¸å…³å†…å®¹å’Œé›†æˆæ–¹æ³•ã€‚</p>


                <hr>

                

                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2021/10/29/20211029/" data-toggle="tooltip" data-placement="top" title="iOS å¦‚ä½•æ›´å¥½çš„é€‚é…å¼‚å½¢å±ï¼ˆåˆ˜æµ·å±ï¼‰">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2019/06/10/20190610/" data-toggle="tooltip" data-placement="top" title="iOS 13 é€‚é…">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                

                

            </div>
    <!-- Side Catalog Container -->
        

    <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                

                <!-- Friends Blog -->
                
            </div>

        </div>
    </div>
</article>









    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Qianxing&#39;s Blog 2023 
                    <br>
                    Theme by <a target="_blank" rel="noopener" href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    Ported by <a target="_blank" rel="noopener" href="http://blog.kaijun.rocks">Kaijun</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://example.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->


<!-- Side Catalog -->





<!-- Image to hack wechat -->
<img src="http://example.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
